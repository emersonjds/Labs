{"version":3,"sources":["index.tsx"],"names":["React","forwardRef","memo","StyleSheet","Platform","default","Box","useHasResponsiveProps","usePropsResolution","AspectView","props","ref","layout","setLayout","useState","aspectViewStyle","flatten","style","width","height","push","aspectRatio","nativeEvent","inLayout","AspectRatio","ratio","children","resolvedProps","resolveResponsively","computedStyle","newChildWithProps","cloneElement","absoluteFillObject","OS"],"mappings":"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","sourcesContent":["import React, { forwardRef, memo } from 'react';\nimport { StyleSheet, ViewStyle, Platform } from 'react-native';\nimport { default as Box } from '../../primitives/Box';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\nimport { usePropsResolution } from '../../../hooks';\nimport type { IAspectRatioProps } from './types';\n\nconst AspectView = forwardRef((props: any, ref?: any) => {\n  const [layout, setLayout] = React.useState();\n  const aspectViewStyle = [StyleSheet.flatten(props.style) || {}];\n  if (layout) {\n    // @ts-ignore\n    let { width = 0, height = 0 } = layout;\n    if (width === 0) {\n      aspectViewStyle.push({ width: height * props.aspectRatio, height });\n    } else {\n      aspectViewStyle.push({ width, height: width / props.aspectRatio });\n    }\n  }\n\n  return (\n    <Box\n      ref={ref}\n      {...props}\n      style={aspectViewStyle}\n      onLayout={({ nativeEvent: { layout: inLayout } }: any) =>\n        setLayout(inLayout)\n      }\n    />\n  );\n});\n\nconst AspectRatio = (props: IAspectRatioProps, ref?: any) => {\n  const { ratio, children = <></>, ...resolvedProps } = usePropsResolution(\n    'AspectRatio',\n    props,\n    {},\n    { resolveResponsively: ['ratio'] }\n  );\n  let computedStyle: ViewStyle | undefined = resolvedProps.style;\n  const newChildWithProps = React.cloneElement(\n    children,\n    {\n      ...children?.props,\n      style: StyleSheet.absoluteFillObject,\n    },\n    children?.props?.children\n  );\n\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(resolvedProps)) {\n    return null;\n  }\n  // DOC:  It uses a aspectRatio property of React Native and manually calculate on Web\n  if (Platform.OS === 'web') {\n    return (\n      <AspectView aspectRatio={ratio} {...resolvedProps} ref={ref}>\n        {newChildWithProps}\n      </AspectView>\n    );\n  } else {\n    computedStyle = StyleSheet.flatten([\n      { style: resolvedProps.style },\n      { aspectRatio: ratio },\n    ]);\n    return (\n      <Box {...resolvedProps} style={computedStyle} ref={ref}>\n        {newChildWithProps}\n      </Box>\n    );\n  }\n};\n\nexport default memo(forwardRef(AspectRatio));\n"]}